"use strict";function _classCallCheck(e,i){if(!(e instanceof i))throw new TypeError("Cannot call a class as a function")}var _createClass=function(){function e(e,i){for(var t=0;t<i.length;t++){var r=i[t];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(i,t,r){return t&&e(i.prototype,t),r&&e(i,r),i}}(),Keyboard=function(){function e(i){_classCallCheck(this,e),this.code=i,this.isDown=!1,this.isUp=!0,this.press=void 0,this.release=void 0,this.init()}return _createClass(e,[{key:"downHandler",value:function(e){e.keyCode==this.code&&(this.isUp&&this.press&&this.press(),this.isDown=!0,this.isUp=!1),e.preventDefault()}},{key:"upHandler",value:function(e){e.keyCode==this.code&&(this.isDown&&this.release&&this.release(),this.isDown=!1,this.isUp=!0),e.preventDefault()}},{key:"init",value:function(){window.addEventListener("keydown",this.downHandler.bind(this),!1),window.addEventListener("keyup",this.upHandler.bind(this),!1)}}]),e}(),App=function(){function e(){var i=this;_classCallCheck(this,e),this.Container=PIXI.Container,this.autoDetectRenderer=PIXI.autoDetectRenderer,this.loader=PIXI.loader,this.resources=PIXI.loader.resources,this.Sprite=PIXI.Sprite,this.Graphics=PIXI.Graphics,this.BaseTexture=PIXI.BaseTexture,this.Texture=PIXI.Texture,this.Text=PIXI.Text,this.radio2=window.innerWidth/640*2,this.renderer=this.autoDetectRenderer(640*this.radio2,1008*this.radio2,{antialias:!1,transparent:!1,resolution:1}),this.stage=new this.Container,this.group=new this.Container,this.graphics=new this.Graphics,this.size=function(e){return e*i.radio2},this.init()}return _createClass(e,[{key:"init",value:function(){console.log(window.dpr,"dpr"),console.log(this.radio2,"radio2"),this.mount(),this.draw()}},{key:"mount",value:function(){document.querySelector("#app").appendChild(this.renderer.view),this.renderer.view.style.display="block",this.renderer.view.style.width=window.innerWidth+"px"}},{key:"draw",value:function(){function e(){requestAnimationFrame(e),t.render(i)}var i=(this.radio2,this.stage),t=(this.group,this.renderer);this.Sprite,this.resources,this.Graphics,this.Text,this.loader,this.Texture,this.size;this.drawGrapgics(),this.drawSprite(),this.drawSriteFromImage(),this.drawAnimationLine(),e()}},{key:"drawAnimationLine",value:function(){var e=(this.radio2,this.stage),i=(this.group,this.renderer),t=(this.Sprite,this.resources,this.Graphics),r=(this.Text,this.loader,this.Texture,this.size),n=new t;e.addChild(n),n.angleA=0,n.angleB=0;var s=void 0,a=function(e,i,t,r,n){var s={};return s.x=e+Math.cos(n)*t,s.y=i+Math.sin(n)*r,s};s=function(){n.angleA+=r(.02);var e=a(r(164),r(64),r(80),r(20),n.angleA);n.angleB-=r(.03);var i=a(r(164),r(208),r(80),r(20),n.angleB);n.clear(),n.lineStyle(r(4),16777215,1).moveTo(e.x,e.y).lineTo(i.x,i.y)};!function t(){requestAnimationFrame(t),s(),i.render(e)}()}},{key:"drawGrapgics",value:function(){var e=this.radio2,i=this.stage,t=this.group,r=(this.renderer,this.Sprite),n=(this.resources,this.Graphics),s=this.Text,a=(this.loader,this.Texture,this.size),o=new n;o.beginFill("0x061639").lineStyle(1*e,"0xffffff",1).drawRect(50*e,250*e,120*e,120*e).endFill();var h=new n;h.beginFill("0xf75555").lineStyle(1*e,"0xffffff",1).drawRect(100*e,350*e,120*e,120*e).endFill();var d=new n;d.beginFill("0x061639").drawEllipse(220*e,490*e,70*e,120*e).endFill();var l=new n,c={x:null,y:null},u=!1;document.addEventListener("touchmove",function(i){(new Date).getTime()-u>100&&(c={x:null,y:null});var t=i.changedTouches[0].pageX,r=i.changedTouches[0].pageY;l.lineStyle(10*e,"0xffffff",1).moveTo(c.x*e?c.x*e:(t-1)*e,c.y*e?c.y*e:(r-1)*e).lineTo((t+1)*e,(r+1)*e),c={x:t,y:r},u=(new Date).getTime()},!1);var f=new n;f.beginFill("0xf75555");var p=[0,0,100*e,200*e,640*e,400*e];f.drawPolygon(p),f.endFill();var w=new s("test",{fontFamily:"Courier",fontSize:32*e,fill:"white",dropShadow:!0});w.position.set(100*e,100*e);var g=new n;g.lineStyle(a(4),16777215,a(1)).moveTo(a(32),a(128)).quadraticCurveTo(a(128),a(20),a(224),a(128));var v=g.generateTexture(),x=new r(v);console.log(g.position,"quad"),t.addChild(x);var m=new n;m.lineStyle(a(4),16777215,a(1)).moveTo(a(32),a(228)).bezierCurveTo(a(32),a(50),a(224),a(50),a(224),a(228)),m.lineStyle(a(20),16209237,a(1)).moveTo(a(66),a(228)).bezierCurveTo(a(66),a(50),a(224),a(50),a(284),a(228)),t.addChild(m);var y=new n;y.lineStyle(a(14),16777215,a(1)).arc(a(64),a(64),a(200),0,Math.PI,!1),t.addChild(y),t.addChild(o),t.addChild(h),t.addChild(d),i.addChild(f),i.addChild(l),i.addChild(w),t.position.set(200*e,200*e),t.backgroundColor="0xffffff",console.log(o.x),console.log(o.getGlobalPosition()),i.addChild(PIXI.Sprite.fromImage("./images/assets/shipin.png")),i.addChild(t)}},{key:"drawSprite",value:function(){var e=this.radio2,i=this.stage,t=(this.group,this.renderer,this.Sprite),r=this.resources;this.Graphics,this.Text,this.loader,this.Texture;PIXI.loader.add("./images/assets/test.json").on("progress",function(e,i){console.log(i,"progress-resource"),console.log(e,"progress-loader")}).load(function(){function n(e,i){i?e.vx-=e.accelerationX:e.vx+=e.accelerationX,e.vx*=e.frictionX,e.x+=e.vx}function s(e,i){e.accelerationX=e.speed,e.frictionX=1,n(e,i)}function a(e,i){e.accelerationX=0,e.frictionX=e.drag,n(e,i)}function o(){for(var i in d)d[i].x<640*e/2?d[i].forward?s(d[i]):(a(d[i],!0),d[i].x<0&&(d[i].forward=!0)):d[i].forward?(a(d[i]),d[i].x>=640*e-100&&(d[i].forward=!1)):s(d[i],!0)}function h(){requestAnimationFrame(h),u()}for(var d=[],l=0;l<1;l++)d.push(new t(r["./images/assets/test.json"].textures["å¸ƒ-r.png"]));for(var c in d)d[c].position.set((c+10)*e,0),d[c]=Object.assign(d[c],{width:d[c].width*e,height:d[c].height*e,accelerationX:0,accelerationY:0,frictionX:1,frictionY:1,speed:.3,drag:.98,vx:1,vy:1}),d[c].jiasu=!0,d[c].forward=!0,i.addChild(d[c]);var u=void 0;u=o,h()})}},{key:"drawSriteFromImage",value:function(){var e=this.radio2,i=this.stage,t=(this.group,this.renderer,this.Sprite,this.resources,this.Graphics,this.Text,this.loader,this.Texture,new Image);t.crossOrigin="Anonymous",t.src="http://dlstest.img4399.com/redirect/mm.img4399.com/ot/y2018/game/timetunnel/static/index/img/index-bg_01.dc47459.png",t.onload=function(){var r=new PIXI.BaseTexture(t),n=new PIXI.Texture(r),s=new PIXI.Sprite(n);s.position.set(0*e,600*e),console.log(s.width,s.height,"imgSprite"),s.scale.set(.5,.5),s.width*=e,s.height*=e,s.pivot.set(s.width/2,s.width/2),s.rotation=Math.PI/180*45,i.addChild(s)}}}]),e}();$(function(){new App});