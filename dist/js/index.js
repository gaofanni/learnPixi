"use strict";function _classCallCheck(e,i){if(!(e instanceof i))throw new TypeError("Cannot call a class as a function")}var _createClass=function(){function e(e,i){for(var t=0;t<i.length;t++){var r=i[t];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(i,t,r){return t&&e(i.prototype,t),r&&e(i,r),i}}(),Keyboard=function(){function e(i){_classCallCheck(this,e),this.code=i,this.isDown=!1,this.isUp=!0,this.press=void 0,this.release=void 0,this.init()}return _createClass(e,[{key:"downHandler",value:function(e){e.keyCode==this.code&&(this.isUp&&this.press&&this.press(),this.isDown=!0,this.isUp=!1),e.preventDefault()}},{key:"upHandler",value:function(e){e.keyCode==this.code&&(this.isDown&&this.release&&this.release(),this.isDown=!1,this.isUp=!0),e.preventDefault()}},{key:"init",value:function(){window.addEventListener("keydown",this.downHandler.bind(this),!1),window.addEventListener("keyup",this.upHandler.bind(this),!1)}}]),e}(),App=function(){function e(){_classCallCheck(this,e),this.Container=PIXI.Container,this.autoDetectRenderer=PIXI.autoDetectRenderer,this.loader=PIXI.loader,this.resources=PIXI.loader.resources,this.Sprite=PIXI.Sprite,this.Graphics=PIXI.Graphics,this.BaseTexture=PIXI.BaseTexture,this.Texture=PIXI.Texture,this.Text=PIXI.Text,this.radio2=window.innerWidth/640*2,this.renderer=this.autoDetectRenderer(640*this.radio2,1008*this.radio2,{antialias:!0,transparent:!1,resolution:1}),this.stage=new this.Container,this.group=new this.Container,this.graphics=new this.Graphics,this.init()}return _createClass(e,[{key:"init",value:function(){console.log(window.dpr,"dpr"),console.log(this.radio2,"radio2"),this.mount(),this.draw()}},{key:"mount",value:function(){document.querySelector("#app").appendChild(this.renderer.view),this.renderer.view.style.display="block",this.renderer.view.style.width=window.innerWidth+"px"}},{key:"draw",value:function(){function e(){requestAnimationFrame(e),t.render(i)}var i=(this.radio2,this.stage),t=(this.group,this.renderer);this.Sprite,this.resources,this.Graphics,this.Text,this.loader,this.Texture;this.drawGrapgics(),this.drawSprite(),this.drawSriteFromImage(),e()}},{key:"drawGrapgics",value:function(){var e=this.radio2,i=this.stage,t=this.group,r=(this.renderer,this.Sprite,this.resources,this.Graphics),s=this.Text,n=(this.loader,this.Texture,new r);n.beginFill("0x061639").lineStyle(1*e,"0xffffff",1).drawRect(50*e,250*e,120*e,120*e).endFill();var o=new r;o.beginFill("0xf75555").lineStyle(1*e,"0xffffff",1).drawRect(100*e,350*e,120*e,120*e).endFill();var a=new r;a.beginFill("0x061639").drawEllipse(220*e,490*e,70*e,120*e).endFill();var h=new r,d={x:null,y:null},l=!1;document.addEventListener("touchmove",function(i){(new Date).getTime()-l>100&&(d={x:null,y:null});var t=i.changedTouches[0].pageX,r=i.changedTouches[0].pageY;h.lineStyle(10*e,"0xffffff",1).moveTo(d.x*e?d.x*e:(t-1)*e,d.y*e?d.y*e:(r-1)*e).lineTo((t+1)*e,(r+1)*e),d={x:t,y:r},l=(new Date).getTime()},!1);var c=new r;c.beginFill("0xf75555");var u=[0,0,100*e,200*e,640*e,400*e];c.drawPolygon(u),c.endFill();var p=new s("test",{fontFamily:"Courier",fontSize:32*e,fill:"white",dropShadow:!0});p.position.set(100*e,100*e),t.addChild(n),t.addChild(o),t.addChild(a),i.addChild(c),i.addChild(h),i.addChild(p),t.position.set(200*e,200*e),console.log(n.x),console.log(n.getGlobalPosition()),i.addChild(PIXI.Sprite.fromImage("./images/assets/shipin.png")),i.addChild(t)}},{key:"drawSprite",value:function(){var e=this.radio2,i=this.stage,t=(this.group,this.renderer,this.Sprite),r=this.resources;this.Graphics,this.Text,this.loader,this.Texture;PIXI.loader.add("./images/assets/test.json").on("progress",function(e,i){console.log(i,"progress-resource"),console.log(e,"progress-loader")}).load(function(){function s(e,i){i?e.vx-=e.accelerationX:e.vx+=e.accelerationX,e.vx*=e.frictionX,e.x+=e.vx}function n(e,i){e.accelerationX=e.speed,e.frictionX=1,s(e,i)}function o(e,i){e.accelerationX=0,e.frictionX=e.drag,s(e,i)}function a(){for(var i in d)d[i].x<640*e/2?d[i].forward?n(d[i]):(o(d[i],!0),d[i].x<0&&(d[i].forward=!0)):d[i].forward?(o(d[i]),d[i].x>=640*e-100&&(d[i].forward=!1)):n(d[i],!0)}function h(){requestAnimationFrame(h),u()}for(var d=[],l=0;l<1;l++)d.push(new t(r["./images/assets/test.json"].textures["å¸ƒ-r.png"]));for(var c in d)d[c].position.set((c+10)*e,0),d[c]=Object.assign(d[c],{width:d[c].width*e,height:d[c].height*e,accelerationX:0,accelerationY:0,frictionX:1,frictionY:1,speed:.3,drag:.98,vx:1,vy:1}),d[c].jiasu=!0,d[c].forward=!0,i.addChild(d[c]);var u=void 0;u=a,h()})}},{key:"drawSriteFromImage",value:function(){var e=this.radio2,i=this.stage,t=(this.group,this.renderer,this.Sprite,this.resources,this.Graphics,this.Text,this.loader,this.Texture,new Image);t.crossOrigin="Anonymous",t.src="http://dlstest.img4399.com/redirect/mm.img4399.com/ot/y2018/game/timetunnel/static/index/img/index-bg_01.dc47459.png",t.onload=function(){var r=new PIXI.BaseTexture(t),s=new PIXI.Texture(r),n=new PIXI.Sprite(s);n.position.set(100*e,600*e),console.log(n.width,n.height,"imgSprite"),n.scale.set(1,1),n.width*=e,n.height*=e,n.rotation=Math.PI/180*30,i.addChild(n)}}}]),e}();$(function(){new App});