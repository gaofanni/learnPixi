"use strict";function _classCallCheck(e,i){if(!(e instanceof i))throw new TypeError("Cannot call a class as a function")}var _createClass=function(){function e(e,i){for(var t=0;t<i.length;t++){var s=i[t];s.enumerable=s.enumerable||!1,s.configurable=!0,"value"in s&&(s.writable=!0),Object.defineProperty(e,s.key,s)}}return function(i,t,s){return t&&e(i.prototype,t),s&&e(i,s),i}}(),Keyboard=function(){function e(i){_classCallCheck(this,e),this.code=i,this.isDown=!1,this.isUp=!0,this.press=void 0,this.release=void 0,this.init()}return _createClass(e,[{key:"downHandler",value:function(e){e.keyCode==this.code&&(this.isUp&&this.press&&this.press(),this.isDown=!0,this.isUp=!1),e.preventDefault()}},{key:"upHandler",value:function(e){e.keyCode==this.code&&(this.isDown&&this.release&&this.release(),this.isDown=!1,this.isUp=!0),e.preventDefault()}},{key:"init",value:function(){window.addEventListener("keydown",this.downHandler.bind(this),!1),window.addEventListener("keyup",this.upHandler.bind(this),!1)}}]),e}(),App=function(){function e(){var i=this;_classCallCheck(this,e),this.Container=PIXI.Container,this.autoDetectRenderer=PIXI.autoDetectRenderer,this.loader=PIXI.loader,this.resources=PIXI.loader.resources,this.Sprite=PIXI.Sprite,this.Graphics=PIXI.Graphics,this.BaseTexture=PIXI.BaseTexture,this.Texture=PIXI.Texture,this.Text=PIXI.Text,this.radio2=window.innerWidth/640*2,this.bump=new Bump(PIXI),this.su=new SpriteUtilities(PIXI),this.d=new Dust(PIXI),this.renderer=this.autoDetectRenderer(640*this.radio2,1008*this.radio2,{antialias:!1,transparent:!1,resolution:1}),this.stage=new this.Container,this.group=new this.Container,this.graphics=new this.Graphics,this.size=function(e){return e*i.radio2},this.init()}return _createClass(e,[{key:"init",value:function(){console.log(window.dpr,"dpr"),console.log(this.radio2,"radio2"),this.mount(),this.draw()}},{key:"mount",value:function(){document.querySelector("#app").appendChild(this.renderer.view),this.renderer.view.style.display="block",this.renderer.view.style.width=window.innerWidth+"px"}},{key:"draw",value:function(){function e(){requestAnimationFrame(e),s.update(),t.render(i)}var i=(this.radio2,this.stage),t=(this.group,this.renderer),s=(this.Sprite,this.resources,this.Graphics,this.Text,this.loader,this.Texture,this.size,this.d);this.drawGrapgics(),e()}},{key:"drawTiling",value:function(){var e=(this.radio2,this.stage),i=(this.group,this.renderer),t=this.Sprite,s=(this.resources,this.Graphics),n=(this.Text,this.loader,this.Texture,this.size);this.d;PIXI.loader.add("./images/assets/box_open.png").load(function(){function r(e){w&&(h.position.copy(e.data.global),i.render(h,c,!1,null,!1))}function a(e){w=!0,r(e)}function o(e){w=!1}var h=new PIXI.Graphics;h.beginFill(16777215),h.drawCircle(0,0,n(50)),h.endFill();var d=new s;d.beginFill(16209237).drawRect(0,0,n(window.innerWidth),n(window.innerHeight)),e.addChild(d);var l=PIXI.loader.resources["./images/assets/box_open.png"].texture,u=new PIXI.extras.TilingSprite(l,n(window.innerWidth),n(window.innerHeight));u.tilePosition.x=n(32),u.tileScale.x=1.5,e.addChild(u);var c=new PIXI.RenderTexture.create(n(window.innerWidth),n(window.innerHeight)),p=new t(c);e.addChild(p),u.mask=p,e.interactive=!0,e.on("pointerdown",a),e.on("pointerup",o),e.on("pointermove",r);var w=!1})}},{key:"drwaParticles",value:function(){var e=this,i=(this.radio2,this.stage),t=(this.group,this.renderer,this.Sprite,this.resources,this.Graphics,this.Text,this.loader,this.Texture,this.size),s=this.d;PIXI.loader.add("./images/assets/star.jpg").load(function(){var n=new PIXI.ParticleContainer;i.addChild(n);var r=s.emitter(100,function(){return s.create(t(window.innerWidth)/2,t(window.innerHeight)/2,function(){return e.su.sprite("./images/assets/star.jpg")},n,50,0,!0,0,2*Math.PI,t(4),t(4),1,2,1,1,.005,.01,.05,.1)});r.play(),setTimeout(function(){r.stop()},1e3)})}},{key:"keyframeAnimation",value:function(){var e=(this.radio2,this.stage),i=(this.group,this.renderer,this.Sprite,this.resources,this.Graphics,this.Text,this.loader,this.Texture,this.size,this.su);PIXI.loader.add("./images/assets/timg.jpg").load(function(){var t=i.filmstrip("./images/assets/timg.jpg",59,93),s=i.sprite(t);s.states={down:0,left:4,right:8,up:12,walkDown:[0,3],walkLeft:[4,7],walkRight:[8,11],walkUp:[12,15]},s.show(s.states.left),s.scale.set(10,10),s.animationSpeed=.2,s.fps=8,s.loop=!0,s.onComplete=function(){console.log(1)},e.addChild(s),s.vx=0;var n=new Keyboard(37);n.press=function(){s.playAnimation(s.states.walkLeft),s.vx=-1,s.vy=0},n.release=function(){r.isDown||0!=s.vy||(s.vx=0,s.show(s.states.left))};var r=new Keyboard(39);r.press=function(){s.playAnimation(s.states.walkRight),s.vx=1,s.vy=0},r.release=function(){n.isDown||0!=s.vy||(s.vx=0,s.show(s.states.right))};!function e(){requestAnimationFrame(e),s.x+=s.vx}()})}},{key:"drawAnimationLine",value:function(){var e=(this.radio2,this.stage),i=(this.group,this.renderer),t=(this.Sprite,this.resources,this.Graphics),s=(this.Text,this.loader,this.Texture,this.size),n=new t;e.addChild(n),e.cacheAsBitmap=!0,n.angleA=0,n.angleB=0;var r=void 0,a=function(e,i,t,s,n){var r={};return r.x=e+Math.cos(n)*t,r.y=i+Math.sin(n)*s,r};r=function(){n.angleA+=s(.02);var e=a(s(164),s(64),s(80),s(20),n.angleA);n.angleB-=s(.03);var i=a(s(164),s(208),s(80),s(20),n.angleB);n.clear(),n.lineStyle(s(4),16777215,1).moveTo(e.x,e.y).lineTo(i.x,i.y)};!function t(){requestAnimationFrame(t),r(),i.render(e)}()}},{key:"drawGrapgics",value:function(){var e=this.radio2,i=this.stage,t=this.group,s=(this.renderer,this.Sprite),n=(this.resources,this.Graphics),r=this.Text,a=(this.loader,this.Texture,this.size),o=new n;o.beginFill("0x061639").lineStyle(1*e,"0xffffff",1).drawRect(50*e,250*e,120*e,120*e).endFill();var h=new n;h.beginFill("0xf75555").lineStyle(1*e,"0xffffff",1).drawRect(100*e,350*e,120*e,120*e).endFill(),h.position.set(a(100),a(100));var d=new n;d.beginFill("0x999999").drawEllipse(220*e,490*e,70*e,120*e).endFill(),d.blendMode=PIXI.BLEND_MODES.SCREEN;var l=new n,u={x:null,y:null},c=!1;document.addEventListener("touchmove",function(i){(new Date).getTime()-c>100&&(u={x:null,y:null});var t=i.changedTouches[0].pageX,s=i.changedTouches[0].pageY;l.lineStyle(10*e,"0xffffff",1).moveTo(u.x*e?u.x*e:(t-1)*e,u.y*e?u.y*e:(s-1)*e).lineTo((t+1)*e,(s+1)*e),u={x:t,y:s},c=(new Date).getTime()},!1);var p=new n;p.beginFill("0xf75555");var w=[0,0,100*e,200*e,640*e,400*e];p.drawPolygon(w),p.endFill();var f=new r("test",{fontFamily:"Courier",fontSize:32*e,fill:"white",dropShadow:!0});f.position.set(100*e,100*e);var g=new n;g.lineStyle(a(4),16777215,a(1)).moveTo(a(32),a(128)).quadraticCurveTo(a(128),a(20),a(224),a(128));var v=g.generateTexture(),x=new s(v);console.log(g.position,"quad"),t.addChild(x);var m=new n;m.lineStyle(a(4),16777215,a(1)).moveTo(a(32),a(228)).bezierCurveTo(a(32),a(50),a(224),a(50),a(224),a(228)).tint=16209237,m.lineStyle(a(20),16209237,a(1)).moveTo(a(66),a(228)).bezierCurveTo(a(66),a(50),a(224),a(50),a(284),a(228)),t.addChild(m);var y=new n;y.lineStyle(a(14),16777215,a(1)).arc(a(64),a(64),a(200),0,Math.PI,!1),t.addChild(y),t.addChild(o),t.addChild(h),t.addChild(d),i.addChild(p),i.addChild(l),i.addChild(f),t.position.set(200*e,200*e),t.backgroundColor="0xffffff",console.log(o.x),console.log(o.getGlobalPosition()),i.addChild(PIXI.Sprite.fromImage("./images/assets/shipin.png")),i.addChild(t)}},{key:"drawSprite",value:function(){var e=this.radio2,i=this.stage,t=(this.group,this.renderer,this.Sprite),s=this.resources;this.Graphics,this.Text,this.loader,this.Texture,this.bump;PIXI.loader.add("./images/assets/test.json").on("progress",function(e,i){console.log(i,"progress-resource"),console.log(e,"progress-loader")}).load(function(){function n(e,i){i?e.vx-=e.accelerationX:e.vx+=e.accelerationX,e.vx*=e.frictionX,e.x+=e.vx}function r(e,i){e.accelerationX=e.speed,e.frictionX=1,n(e,i)}function a(e,i){e.accelerationX=0,e.frictionX=e.drag,n(e,i)}function o(){for(var i in d)d[i].x<640*e/2?d[i].forward?r(d[i]):(a(d[i],!0),d[i].x<0&&(d[i].forward=!0)):d[i].forward?(a(d[i]),d[i].x>=640*e-100&&(d[i].forward=!1)):r(d[i],!0)}function h(){requestAnimationFrame(h),c()}for(var d=[],l=0;l<1;l++)d.push(new t(s["./images/assets/test.json"].textures["å¸ƒ-r.png"]));for(var u in d)d[u].position.set((u+10)*e,0),d[u]=Object.assign(d[u],{width:d[u].width*e,height:d[u].height*e,accelerationX:0,accelerationY:0,frictionX:1,frictionY:1,speed:.3,drag:.98,vx:1,vy:1}),d[u].jiasu=!0,d[u].forward=!0,d[u].tint=16724736,i.addChild(d[u]);var c=void 0;c=o,h()})}},{key:"drawSriteFromImage",value:function(){var e=this.radio2,i=this.stage,t=(this.group,this.renderer,this.Sprite,this.resources,this.Graphics,this.Text,this.loader,this.Texture,new Image);t.crossOrigin="Anonymous",t.src="http://dlstest.img4399.com/redirect/mm.img4399.com/ot/y2018/game/timetunnel/static/index/img/index-bg_01.dc47459.png",t.onload=function(){var s=new PIXI.BaseTexture(t),n=new PIXI.Texture(s),r=new PIXI.Sprite(n);r.position.set(0*e,600*e),console.log(r.width,r.height,"imgSprite"),r.scale.set(.5,.5),r.width*=e,r.height*=e,r.pivot.set(r.width/2,r.width/2),r.rotation=Math.PI/180*45,i.addChild(r)}}}]),e}();$(function(){new App});